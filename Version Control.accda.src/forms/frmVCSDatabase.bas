Version =20
VersionRequired =20
Begin Form
    PopUp = NotDefault
    RecordSelectors = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ScrollBars =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =10800
    DatasheetFontHeight =11
    ItemSuffix =263
    Left =20761
    Top =2250
    Right =31426
    Bottom =13995
    RecSrcDt = Begin
        0x79e78b777268e540
    End
    Caption ="Version Control System"
    DatasheetFontName ="Calibri"
    OnLoad ="[Event Procedure]"
    AllowDatasheetView =0
    FilterOnLoad =0
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    FitToScreen =1
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            BorderLineStyle =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Line
            BorderLineStyle =0
            BorderThemeColorIndex =0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            BorderLineStyle =0
            SizeMode =3
            PictureAlignment =2
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CommandButton
            FontSize =11
            FontWeight =400
            FontName ="Calibri"
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =1
            Gradient =12
            BackThemeColorIndex =4
            BackTint =60.0
            BorderLineStyle =0
            BorderThemeColorIndex =4
            BorderTint =60.0
            ThemeFontIndex =1
            HoverThemeColorIndex =4
            HoverTint =40.0
            PressedThemeColorIndex =4
            PressedShade =75.0
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
        End
        Begin CheckBox
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin OptionGroup
            SpecialEffect =3
            BorderLineStyle =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin TextBox
            AddColon = NotDefault
            FELineBreak = NotDefault
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ThemeFontIndex =1
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ListBox
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ComboBox
            AddColon = NotDefault
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Tab
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =3
            BackThemeColorIndex =1
            BackShade =85.0
            BorderLineStyle =0
            BorderThemeColorIndex =2
            BorderTint =60.0
            HoverThemeColorIndex =1
            PressedThemeColorIndex =1
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
            ForeThemeColorIndex =0
            ForeTint =75.0
        End
        Begin Page
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Section
            Height =7560
            BackColor =15130848
            Name ="Detail"
            AlternateBackColor =15130848
            Begin
                Begin Line
                    BorderWidth =5
                    OverlapFlags =85
                    Top =1080
                    Width =10800
                    BorderColor =15321539
                    Name ="Line10"
                    HorizontalAnchor =2
                    LayoutCachedTop =1080
                    LayoutCachedWidth =10800
                    LayoutCachedHeight =1080
                    BorderThemeColorIndex =-1
                End
                Begin Rectangle
                    SpecialEffect =0
                    BackStyle =1
                    OldBorderStyle =0
                    OverlapFlags =93
                    Width =10800
                    Height =1020
                    BackColor =5324600
                    Name ="Box1"
                    HorizontalAnchor =2
                    LayoutCachedWidth =10800
                    LayoutCachedHeight =1020
                    BackThemeColorIndex =-1
                End
                Begin Label
                    OverlapFlags =215
                    Left =540
                    Top =240
                    Width =6060
                    Height =540
                    FontSize =18
                    FontWeight =700
                    Name ="lblOptions"
                    Caption ="External Database Connection"
                    LayoutCachedLeft =540
                    LayoutCachedTop =240
                    LayoutCachedWidth =6600
                    LayoutCachedHeight =780
                    ForeThemeColorIndex =1
                    ForeTint =100.0
                End
                Begin Label
                    OverlapFlags =85
                    Left =7500
                    Top =1560
                    Width =2760
                    Height =3360
                    ForeColor =5324600
                    Name ="Label227"
                    Caption ="This add-in provides limited support for exporting object definitions from exter"
                        "nal databases for use in version control.\015\012\015\012* If the connection str"
                        "ing contains a password, please use the .env option, and exclude this file from "
                        "version control."
                    HorizontalAnchor =1
                    LayoutCachedLeft =7500
                    LayoutCachedTop =1560
                    LayoutCachedWidth =10260
                    LayoutCachedHeight =4920
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                End
                Begin TextBox
                    OverlapFlags =215
                    IMESentenceMode =3
                    Left =720
                    Top =1800
                    Width =3720
                    Height =315
                    Name ="txtName"
                    HorizontalAnchor =2

                    LayoutCachedLeft =720
                    LayoutCachedTop =1800
                    LayoutCachedWidth =4440
                    LayoutCachedHeight =2115
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =720
                            Top =1500
                            Width =2160
                            Height =315
                            ForeColor =5324600
                            Name ="Label244"
                            Caption ="Connection Name:"
                            HorizontalAnchor =2
                            LayoutCachedLeft =720
                            LayoutCachedTop =1500
                            LayoutCachedWidth =2880
                            LayoutCachedHeight =1815
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =215
                    IMESentenceMode =3
                    Left =720
                    Top =3480
                    Width =6060
                    Height =315
                    TabIndex =4
                    Name ="txtDescription"
                    HorizontalAnchor =2

                    LayoutCachedLeft =720
                    LayoutCachedTop =3480
                    LayoutCachedWidth =6780
                    LayoutCachedHeight =3795
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =720
                            Top =3180
                            Width =1920
                            Height =315
                            ForeColor =5324600
                            Name ="Label246"
                            Caption ="Description:"
                            HorizontalAnchor =2
                            LayoutCachedLeft =720
                            LayoutCachedTop =3180
                            LayoutCachedWidth =2640
                            LayoutCachedHeight =3495
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin TextBox
                    EnterKeyBehavior = NotDefault
                    OverlapFlags =215
                    IMESentenceMode =3
                    Left =720
                    Top =5160
                    Width =6060
                    Height =1380
                    TabIndex =8
                    Name ="txtFilter"
                    HorizontalAnchor =2
                    VerticalAnchor =2

                    LayoutCachedLeft =720
                    LayoutCachedTop =5160
                    LayoutCachedWidth =6780
                    LayoutCachedHeight =6540
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =720
                            Top =4860
                            Width =4620
                            Height =315
                            ForeColor =5324600
                            Name ="Label250"
                            Caption ="Filter for database objects (source file paths):"
                            LayoutCachedLeft =720
                            LayoutCachedTop =4860
                            LayoutCachedWidth =5340
                            LayoutCachedHeight =5175
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin CommandButton
                    Cancel = NotDefault
                    OverlapFlags =85
                    Left =6540
                    Top =6900
                    Width =1500
                    Height =420
                    TabIndex =9
                    Name ="cmdCancel"
                    Caption ="Cancel"
                    OnClick ="[Event Procedure]"
                    LeftPadding =135
                    TopPadding =135
                    RightPadding =150
                    BottomPadding =150
                    HorizontalAnchor =1
                    VerticalAnchor =1

                    LayoutCachedLeft =6540
                    LayoutCachedTop =6900
                    LayoutCachedWidth =8040
                    LayoutCachedHeight =7320
                    BackColor =14262935
                    BackThemeColorIndex =-1
                    BackTint =100.0
                    BorderColor =15321539
                    BorderThemeColorIndex =-1
                    BorderTint =100.0
                    HoverColor =15321539
                    HoverThemeColorIndex =-1
                    HoverTint =100.0
                    PressedColor =13072231
                    PressedThemeColorIndex =-1
                    PressedShade =100.0
                    WebImagePaddingLeft =9
                    WebImagePaddingTop =9
                    WebImagePaddingRight =9
                    WebImagePaddingBottom =9
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =8340
                    Top =6900
                    Width =1860
                    Height =420
                    TabIndex =10
                    Name ="cmdSaveAndClose"
                    Caption =" Save && Close"
                    OnClick ="[Event Procedure]"
                    LeftPadding =135
                    TopPadding =135
                    RightPadding =150
                    BottomPadding =150
                    HorizontalAnchor =1
                    VerticalAnchor =1
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000000000000000000000d0687050c06860ffb05850ffa05050ffa05050ff ,
                        0xa05050ff904850ff904840ff904840ff804040ff803840ff803840ff703840ff ,
                        0x703830ff0000000000000000d06870fff09090ffe08080ffb04820ff403020ff ,
                        0xc0b8b0ffc0b8b0ffd0c0c0ffd0c8c0ff505050ffa04030ffa04030ffa03830ff ,
                        0x703840ff0000000000000000d07070ffff98a0fff08880ffe08080ff705850ff ,
                        0x404030ff907870fff0e0e0fff0e8e0ff908070ffa04030ffa04040ffa04030ff ,
                        0x803840ff0000000000000000d07870ffffa0a0fff09090fff08880ff705850ff ,
                        0x000000ff404030fff0d8d0fff0e0d0ff807860ffb04840ffb04840ffa04040ff ,
                        0x804040ff0000000000000000d07880ffffa8b0ffffa0a0fff09090ff705850ff ,
                        0x705850ff705850ff705850ff706050ff806860ffc05850ffb05050ffb04840ff ,
                        0x804040ff0000000000000000e08080ffffb0b0ffffb0b0ffffa0a0fff09090ff ,
                        0xf08880ffe08080ffe07880ffd07070ffd06870ffc06060ffc05850ffb05050ff ,
                        0x904840ff0000000000000000e08890ffffb8c0ffffb8b0ffd06060ffc06050ff ,
                        0xc05850ffc05040ffb05030ffb04830ffa04020ffa03810ffc06060ffc05850ff ,
                        0x904840ff0000000000000000e09090ffffc0c0ffd06860ffffffffffffffffff ,
                        0xfff8f0fff0f0f0fff0e8e0fff0d8d0ffe0d0c0ffe0c8c0ffa03810ffc06060ff ,
                        0x904850ff0000000000000000e098a0ffffc0c0ffd07070ffffffffffffffffff ,
                        0xfffffffffff8f0fff0f0f0fff0e8e0fff0d8d0ffe0d0c0ffa04020ffd06860ff ,
                        0xa05050ff0000000000000000f0a0a0ffffc0c0ffe07870ffffffffffffffffff ,
                        0xfffffffffffffffffff8f0fff0f0f0fff0e8e0fff0d8d0ffb04830ffd07070ff ,
                        0xa05050ff0000000000000000f0a8a0ffffc0c0ffe08080ffffffffffffffffff ,
                        0xfffffffffffffffffffffffffff8f0fff0f0f0fff0e8e0ffb05030ffe07880ff ,
                        0xa05050ff0000000000000000f0b0b0ffffc0c0fff08890ffffffffffffffffff ,
                        0xfffffffffffffffffffffffffffffffffff8f0fff0f0f0ffc05040ff603030ff ,
                        0xb05850ff0000000000000000f0b0b0ffffc0c0ffff9090ffffffffffffffffff ,
                        0xfffffffffffffffffffffffffffffffffffffffffff8f0ffc05850ffb05860ff ,
                        0xb05860ff0000000000000000f0b8b0fff0b8b0fff0b0b0fff0b0b0fff0a8b0ff ,
                        0xf0a0a0ffe098a0ffe09090ffe09090ffe08890ffe08080ffd07880ffd07870ff ,
                        0xd07070ff00000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End

                    LayoutCachedLeft =8340
                    LayoutCachedTop =6900
                    LayoutCachedWidth =10200
                    LayoutCachedHeight =7320
                    PictureCaptionArrangement =5
                    BackColor =14262935
                    BackThemeColorIndex =-1
                    BackTint =100.0
                    BorderColor =15321539
                    BorderThemeColorIndex =-1
                    BorderTint =100.0
                    HoverColor =15321539
                    HoverThemeColorIndex =-1
                    HoverTint =100.0
                    PressedColor =13072231
                    PressedThemeColorIndex =-1
                    PressedShade =100.0
                    WebImagePaddingLeft =9
                    WebImagePaddingTop =9
                    WebImagePaddingRight =9
                    WebImagePaddingBottom =9
                End
                Begin CommandButton
                    FontUnderline = NotDefault
                    OverlapFlags =85
                    Left =3720
                    Top =6960
                    Width =1560
                    TabIndex =11
                    Name ="cmdSeeDocs"
                    Caption ="See Docs..."
                    HyperlinkAddress ="https://github.com/joyfullservice/msaccess-vcs-addin/wiki/Documentation"
                    HorizontalAnchor =1
                    VerticalAnchor =1
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000e0e8e000e0c8b000 ,
                        0xe0d8d000e0d0c010e0d0c010d0d0c010d0d0c000d0d0d000e0e0e00000000000 ,
                        0x0000000000000000000000000000000000000000f0e8e0009068303080582080 ,
                        0x905010c0804820e0804820c0804810b06040108050381030d0c8c01000000000 ,
                        0x000000000000000000000000e0780000e0a05010a0683070c08860f0e0c8b0ff ,
                        0xf0f0f0fffffffffffffffffff0f0f0ffe0c8c0ffa07850c040301060d0c8c010 ,
                        0xe0d8d0000000000000000000e0882000b0703070e0a880fffff0e0ffe0b8a0ff ,
                        0xd08050ffc05820ffc05820ffd08050ffe0b8a0fff0e8e0ffb09070f050301060 ,
                        0xd0c8c000e0e0e00000000000b0783030d09870f0fff0e0ffe0a890ffc05010ff ,
                        0xc05010ffe0a890ffffffffffb04810ffb04810ffd0a080fff0f0e0ffa07050d0 ,
                        0x50381030d0d0d000f0f0f000b0784080f0d8c0fff0c8b0ffe05820ffd05810ff ,
                        0xd05010ffe08050ffe0a880ffc05010ffb04810ffb04810ffe0b8a0ffe0c8c0ff ,
                        0x50401080d0d0d010f0f0f000d08040e0fff8f0fff09870fff06020ffe05820ff ,
                        0xe05820fff0a890ffffffffffd05010ffc05010ffb05010ffc07850fff0f0f0ff ,
                        0x804020c0e0d0c000f0f0f000d08040f0ffffffffff7840ffff6830fff06820ff ,
                        0xf06020fff08850fffffffffff0c0b0ffc05820ffb05010ffb05820ffffffffff ,
                        0x804820e0e0d0c010f0f0f000d08850f0ffffffffff8050ffff7030ffff6830ff ,
                        0xff6830ffff6820fff09060fffff8f0fff0d8c0ffc05020ffc05820ffffffffff ,
                        0x804820e0e0d8d010f0f0f000d08050c0fff8f0ffffa880ffff7040ffff8850ff ,
                        0xffb090ffff7030fff06820fff09070fffffffffff08050ffd08860fffff0f0ff ,
                        0x805820b0e0d8d010f0f0f000c0804070f0d8c0ffffd0c0ffff7840ffff9870ff ,
                        0xffffffffffc8b0ffff9060ffffc8b0fffff8f0fff07840fff0c8b0ffe0c8b0ff ,
                        0x90602070e0c8b00000000000c0884030e0a070f0fff8f0ffffc0a0ffff7840ff ,
                        0xffb8a0fffff8f0fffffffffffff0e0ffff9870fff0b8a0fffff0e0ffc08850e0 ,
                        0xa0682030f0e8e0000000000000000000c0884060e0b8a0f0fff8f0ffffd0c0ff ,
                        0xffa880ffff8850ffff8850ffffa880fff0d0c0fffff0e0ffd0a880f0a0683060 ,
                        0xe0c0a00000000000000000000000000000000000c0884060e0a070f0f0d8c0ff ,
                        0xfff8f0fffffffffffffffffffff8f0fff0d8c0ffc09060e0a0703050f0b89000 ,
                        0x0000000000000000000000000000000000000000f0f0f000c0884030c0804070 ,
                        0xe0a070c0d09870e0d09860f0d09870d0b0784070b0784020f0e8f00000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0xf0f0f000f0f0f000f0f0f000f0f0f000f0f0f00000000000f0f0f00000000000 ,
                        0x0000000000000000
                    End
                    BackStyle =0

                    LayoutCachedLeft =3720
                    LayoutCachedTop =6960
                    LayoutCachedWidth =5280
                    LayoutCachedHeight =7320
                    PictureCaptionArrangement =4
                    ForeThemeColorIndex =10
                    ForeTint =100.0
                    Gradient =0
                    BackColor =14262935
                    BackThemeColorIndex =-1
                    BackTint =100.0
                    OldBorderStyle =0
                    BorderColor =15321539
                    BorderThemeColorIndex =-1
                    BorderTint =100.0
                    HoverColor =15321539
                    HoverThemeColorIndex =-1
                    HoverTint =100.0
                    PressedColor =13072231
                    PressedThemeColorIndex =-1
                    PressedShade =100.0
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =2
                    WebImagePaddingBottom =2
                End
                Begin Label
                    OverlapFlags =85
                    Left =240
                    Top =7020
                    Width =3375
                    Height =240
                    FontSize =10
                    Name ="Label32"
                    Caption ="joyfullservice/msaccess-vcs-addin"
                    VerticalAnchor =1
                    LayoutCachedLeft =240
                    LayoutCachedTop =7020
                    LayoutCachedWidth =3615
                    LayoutCachedHeight =7260
                    ForeThemeColorIndex =1
                    ForeTint =100.0
                    ForeShade =50.0
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =215
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =720
                    Top =2640
                    Width =3720
                    Height =315
                    TabIndex =1
                    Name ="cboType"
                    RowSourceType ="Value List"
                    RowSource ="\"1\";\"Microsoft SQL Server\";\"2\";\"MySQL Server\""
                    ColumnWidths ="0"
                    HorizontalAnchor =2

                    LayoutCachedLeft =720
                    LayoutCachedTop =2640
                    LayoutCachedWidth =4440
                    LayoutCachedHeight =2955
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =720
                            Top =2340
                            Width =2340
                            Height =315
                            ForeColor =5324600
                            Name ="Label252"
                            Caption ="Database Type:"
                            LayoutCachedLeft =720
                            LayoutCachedTop =2340
                            LayoutCachedWidth =3060
                            LayoutCachedHeight =2655
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =7500
                    Top =5100
                    Width =2760
                    Height =1380
                    ForeColor =5324600
                    Name ="Label253"
                    Caption ="Filter paths to source files. Start line with ! to exclude match. Use * for wild"
                        "card matches (LIKE comparison)."
                    HorizontalAnchor =1
                    LayoutCachedLeft =7500
                    LayoutCachedTop =5100
                    LayoutCachedWidth =10260
                    LayoutCachedHeight =6480
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                End
                Begin CommandButton
                    FontUnderline = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =87
                    Left =5340
                    Top =4860
                    Width =1140
                    Height =240
                    FontSize =10
                    TabIndex =7
                    Name ="cmdTest"
                    Caption ="Test Filter..."
                    OnClick ="[Event Procedure]"
                    LeftPadding =135
                    TopPadding =135
                    RightPadding =150
                    BottomPadding =150
                    HorizontalAnchor =1
                    BackStyle =0

                    CursorOnHover =1
                    LayoutCachedLeft =5340
                    LayoutCachedTop =4860
                    LayoutCachedWidth =6480
                    LayoutCachedHeight =5100
                    Alignment =1
                    ForeThemeColorIndex =10
                    ForeTint =100.0
                    Gradient =0
                    BackColor =5324600
                    BackThemeColorIndex =-1
                    BackTint =100.0
                    OldBorderStyle =0
                    BorderColor =15321539
                    BorderThemeColorIndex =-1
                    BorderTint =100.0
                    HoverThemeColorIndex =10
                    HoverTint =100.0
                    PressedThemeColorIndex =10
                    PressedShade =100.0
                    HoverForeThemeColorIndex =10
                    HoverForeTint =100.0
                    PressedForeThemeColorIndex =10
                    PressedForeTint =100.0
                    WebImagePaddingLeft =9
                    WebImagePaddingTop =9
                    WebImagePaddingRight =10
                    WebImagePaddingBottom =10
                    Overlaps =1
                End
                Begin CheckBox
                    OverlapFlags =85
                    Left =4740
                    Top =4050
                    TabIndex =5
                    Name ="chkSaveDotEnv"
                    DefaultValue ="True"
                    HorizontalAnchor =1

                    LayoutCachedLeft =4740
                    LayoutCachedTop =4050
                    LayoutCachedWidth =5000
                    LayoutCachedHeight =4290
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =5040
                            Top =4020
                            Width =1740
                            Height =315
                            ForeColor =5324600
                            Name ="Label257"
                            Caption ="Save in .env file*"
                            HorizontalAnchor =1
                            LayoutCachedLeft =5040
                            LayoutCachedTop =4020
                            LayoutCachedWidth =6780
                            LayoutCachedHeight =4335
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =85
                    Left =4740
                    Top =2250
                    TabIndex =3
                    Name ="chkUtcDates"
                    DefaultValue ="False"
                    HorizontalAnchor =1

                    LayoutCachedLeft =4740
                    LayoutCachedTop =2250
                    LayoutCachedWidth =5000
                    LayoutCachedHeight =2490
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =5040
                            Top =2220
                            Width =1620
                            Height =315
                            ForeColor =5324600
                            Name ="Label259"
                            Caption ="Use UTC Dates"
                            HorizontalAnchor =1
                            LayoutCachedLeft =5040
                            LayoutCachedTop =2220
                            LayoutCachedWidth =6660
                            LayoutCachedHeight =2535
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =85
                    Left =4740
                    Top =1830
                    TabIndex =2
                    Name ="chkEnabled"
                    DefaultValue ="True"
                    HorizontalAnchor =1

                    LayoutCachedLeft =4740
                    LayoutCachedTop =1830
                    LayoutCachedWidth =5000
                    LayoutCachedHeight =2070
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =5040
                            Top =1800
                            Width =1080
                            Height =315
                            ForeColor =5324600
                            Name ="Label261"
                            Caption ="Enabled"
                            HorizontalAnchor =1
                            LayoutCachedLeft =5040
                            LayoutCachedTop =1800
                            LayoutCachedWidth =6120
                            LayoutCachedHeight =2115
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin ComboBox
                    RowSourceTypeInt =1
                    OverlapFlags =215
                    IMESentenceMode =3
                    Left =720
                    Top =4320
                    Width =6060
                    Height =315
                    TabIndex =6
                    Name ="cboConnect"
                    RowSourceType ="Value List"
                    HorizontalAnchor =2

                    LayoutCachedLeft =720
                    LayoutCachedTop =4320
                    LayoutCachedWidth =6780
                    LayoutCachedHeight =4635
                    ForeThemeColorIndex =0
                    ForeTint =75.0
                    ForeShade =100.0
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =720
                            Top =4020
                            Width =2940
                            Height =315
                            ForeColor =5324600
                            Name ="Label248"
                            Caption ="Connection String:"
                            HorizontalAnchor =2
                            LayoutCachedLeft =720
                            LayoutCachedTop =4020
                            LayoutCachedWidth =3660
                            LayoutCachedHeight =4335
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin CommandButton
                    FontUnderline = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =720
                    Top =6600
                    Width =1140
                    Height =240
                    FontSize =10
                    TabIndex =12
                    Name ="cmdExamples"
                    Caption ="Examples..."
                    LeftPadding =135
                    TopPadding =135
                    RightPadding =150
                    BottomPadding =150
                    VerticalAnchor =1
                    BackStyle =0

                    CursorOnHover =1
                    LayoutCachedLeft =720
                    LayoutCachedTop =6600
                    LayoutCachedWidth =1860
                    LayoutCachedHeight =6840
                    Alignment =1
                    ForeThemeColorIndex =10
                    ForeTint =100.0
                    Gradient =0
                    BackColor =5324600
                    BackThemeColorIndex =-1
                    BackTint =100.0
                    OldBorderStyle =0
                    BorderColor =15321539
                    BorderThemeColorIndex =-1
                    BorderTint =100.0
                    HoverThemeColorIndex =10
                    HoverTint =100.0
                    PressedThemeColorIndex =10
                    PressedShade =100.0
                    HoverForeThemeColorIndex =10
                    HoverForeTint =100.0
                    PressedForeThemeColorIndex =10
                    PressedForeTint =100.0
                    WebImagePaddingLeft =9
                    WebImagePaddingTop =9
                    WebImagePaddingRight =10
                    WebImagePaddingBottom =10
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit


' Store original name, just in case we rename an existing entry.
Private m_strOriginalName As String


'---------------------------------------------------------------------------------------
' Procedure : LoadSchema
' Author    : Adam Waller
' Date      : 7/20/2023
' Purpose   : Load a schema by name
'---------------------------------------------------------------------------------------
'
Public Sub LoadSchema(strName As String, dSchema As Dictionary)

    Dim dParams As Dictionary

    ' Merge values into defaults to ensure that all values are defined
    Set dParams = GetDefaults
    MergeDictionary dParams, dSchema
    MergeDotEnv strName, dParams

    ' Load values from dictionary parameters
    txtName = strName
    chkEnabled = dParams("Enabled")
    cboType = dParams("DatabaseType")
    chkUtcDates = dParams("UtcDateTime")
    txtDescription = dParams("Description")
    txtFilter = dParams("Filter")
    cboConnect = dParams("Connect")
    chkSaveDotEnv = dParams("UseDotEnv")

End Sub


'---------------------------------------------------------------------------------------
' Procedure : MergeDotEnv
' Author    : Adam Waller
' Date      : 7/31/2023
' Purpose   : Merge any specified .env params into dictionary. (Will override schema
'           : options saved in vcs-options.json)
'---------------------------------------------------------------------------------------
'
Private Sub MergeDotEnv(strSchemaName As String, ByRef dParams As Dictionary)
    Dim strFile As String
    strFile = BuildPath2(Options.GetExportFolder & "databases", GetSafeFileName(strSchemaName), ".env")
    If FSO.FileExists(strFile) Then
        With New clsDotEnv
            .LoadFromFile strFile
            .MergeIntoDictionary dParams, False
        End With
    End If
End Sub


'---------------------------------------------------------------------------------------
' Procedure : SaveConnectionString
' Author    : Adam Waller
' Date      : 7/20/2023
' Purpose   : Saves the connection string to a .env file.
'---------------------------------------------------------------------------------------
'
Private Sub SaveConnectionStringToFile()

    Dim strFile As String

    ' Guard clause safety check
    If Nz(txtName) = vbNullString Or Nz(cboConnect) = vbNullString Then Exit Sub

    ' Update the value in the .env file. (Creating the file, if needed.)
    strFile = BuildPath2(Options.GetExportFolder & "databases", GetSafeFileName(Nz(txtName)), ".env")
    With New clsDotEnv
        ' Reload file so we preserve existing values
        .LoadFromFile strFile
        .SetVar "CONNECT", Nz(cboConnect)
        .SaveToFile strFile
    End With

End Sub


'---------------------------------------------------------------------------------------
' Procedure : cmdCancel_Click
' Author    : Adam Waller
' Date      : 7/20/2023
' Purpose   : Close this form
'---------------------------------------------------------------------------------------
'
Private Sub cmdCancel_Click()
    DoCmd.Close acForm, Me.Name
End Sub


'---------------------------------------------------------------------------------------
' Procedure : cmdSaveAndClose_Click
' Author    : Adam Waller
' Date      : 7/20/2023
' Purpose   : Save the schema back to the options form.
'---------------------------------------------------------------------------------------
'
Private Sub cmdSaveAndClose_Click()
    If SaveConnection Then
        Form_frmVCSOptions.RefreshSchemaList
        DoCmd.Close acForm, Me.Name
    End If
End Sub


'---------------------------------------------------------------------------------------
' Procedure : SaveConnection
' Author    : Adam Waller
' Date      : 7/21/2023
' Purpose   : Save the current connection, return true if successful.
'---------------------------------------------------------------------------------------
'
Private Function SaveConnection() As Boolean

    Dim dSchema As Dictionary
    Dim strKey As String

    If Not PassedValidation Then Exit Function

    If IsLoaded(acForm, "frmVCSOptions") Then
        With Form_frmVCSOptions.DatabaseSchemas

            ' Get a reference to dictionary object
            strKey = Nz(txtName)
            If Not .Exists(strKey) Then
                ' Could be a rename
                Set dSchema = New Dictionary
                .Add strKey, dSchema
                ' Remove any previous entry
                If Len(m_strOriginalName) Then
                    If .Exists(m_strOriginalName) Then .Remove m_strOriginalName
                End If
            End If

            ' Load form values
            SetParamsFromForm .Item(strKey)

            ' Connection string
            If chkSaveDotEnv Then
                CheckGitignoreDotEnv
                ' Save connection string to .env file
                SaveConnectionStringToFile
                ' Remove connect parameter from dictionary
                If .Item(strKey).Exists("Connect") Then .Item(strKey).Remove "Connect"
            End If
        End With

        ' Return success
        SaveConnection = True
    Else
        MsgBox2 "Options form not found", "The Options form must be open to save changes to external database connections", , vbExclamation
    End If

End Function


'---------------------------------------------------------------------------------------
' Procedure : SetParamsFromForm
' Author    : Adam Waller
' Date      : 7/31/2023
' Purpose   : Sets the dictionary parameters based on the current form values.
'           : (This is especially helpful for testing filters before saving an entry.)
'---------------------------------------------------------------------------------------
'
Private Sub SetParamsFromForm(ByRef dParams As Dictionary)
    With dParams
        .Item("Enabled") = chkEnabled
        .Item("DatabaseType") = CInt(cboType)
        .Item("Description") = Nz(txtDescription)
        .Item("Filter") = Nz(txtFilter)
        .Item("UtcDateTime") = CBool(chkUtcDates)
        .Item("Connect") = Nz(cboConnect)
        .Item("UseDotEnv") = CBool(chkSaveDotEnv)
    End With
End Sub


'---------------------------------------------------------------------------------------
' Procedure : GetDefaults
' Author    : Adam Waller
' Date      : 7/31/2023
' Purpose   : Set the default values for connection parameters
'---------------------------------------------------------------------------------------
'
Private Function GetDefaults() As Dictionary
    Set GetDefaults = New Dictionary
    With GetDefaults
        .CompareMode = TextCompare
        .Item("Enabled") = True
        .Item("DatabaseType") = 1
        .Item("Description") = vbNullString
        .Item("Filter") = vbNullString
        .Item("UtcDateTime") = False
        .Item("Connect") = vbNullString
        .Item("UseDotEnv") = True
    End With
End Function


'---------------------------------------------------------------------------------------
' Procedure : PassedValidation
' Author    : Adam Waller
' Date      : 7/20/2023
' Purpose   : Return true if we pass validation on the form to save the entry.
'---------------------------------------------------------------------------------------
'
Private Function PassedValidation() As Boolean

    Dim strMsg As String

    ' TODO: Could add more validation for filter entries

    If Len(Nz(cboConnect)) < 5 Then strMsg = "Please select or enter a connection string for database"
    If Nz(cboType, -1) < 0 Then strMsg = "Please select database type"
    If Len(Nz(txtName)) = 0 Then strMsg = "Connection name is required"

    If Len(strMsg) Then
        MsgBox2 "Please fix validation issues to continue", strMsg, "See online wiki for additional documentation", vbExclamation
    Else
        PassedValidation = True
    End If

End Function


'---------------------------------------------------------------------------------------
' Procedure : cmdTest_Click
' Author    : Adam Waller
' Date      : 7/21/2023
' Purpose   : Test the current filter and return the number of objects found.
'---------------------------------------------------------------------------------------
'
Private Sub cmdTest_Click()

    Dim cSchema As IDbSchema
    Dim lngCount As Long
    Dim dblStart As Double
    Dim dParams As Dictionary

    txtFilter.SetFocus
    txtFilter.SelStart = 9999
    If Not PassedValidation Then Exit Sub

    Select Case cboType
        Case eDatabaseServerType.estMsSql
            Set cSchema = New clsSchemaMsSql
        'Case eDatabaseServerType.estMsSql
    End Select

    ' Retrieve object count from server.
    If Not cSchema Is Nothing Then
        Set dParams = New Dictionary
        dParams.CompareMode = TextCompare
        SetParamsFromForm dParams
        cSchema.Initialize dParams
        dblStart = Perf.MicroTimer
        DoCmd.Hourglass True
        lngCount = cSchema.ObjectCount(False)
        DoCmd.Hourglass False
        MsgBox2 lngCount & " Objects Found", "A total of " & lngCount & " database objects were retrieved in " & _
            Round(Perf.MicroTimer - dblStart, 2) & " seconds.", , vbInformation
    End If

End Sub


'---------------------------------------------------------------------------------------
' Procedure : CheckGitignoreDotEnv
' Author    : Adam Waller
' Date      : 7/31/2023
' Purpose   : If the project appears to be a .git repository, check to see if .env
'           : appears in the .gitignore file.
'           : (This is not a comprehensive test, but just an extra aid for most common
'           :  scenarios to help users avoid inadvertently comitting a .env file to
'           :  their version control system.)
'---------------------------------------------------------------------------------------
'
Private Sub CheckGitignoreDotEnv()

    Dim strPath As String
    Dim strContent As String

    ' Guess at the standard location for a .gitignore file
    strPath = Options.GetExportFolder & "..\.gitignore"
    If FSO.FileExists(strPath) Then
        strContent = ReadFile(strPath)
        If Len(strContent) Then
            If InStr(1, strContent, ".env", vbTextCompare) = 0 Then
                MsgBox2 "Potentially Sensitive File", _
                    "Please note: .env files should not be committed to version control.", _
                    "To avoid exposing credentials to your repository, please exclude .env files in .gitignore", _
                    vbExclamation
            End If
        End If
    End If

End Sub


'---------------------------------------------------------------------------------------
' Procedure : Form_Load
' Author    : Adam Waller
' Date      : 8/1/2023
' Purpose   : Load in sample connection strings from the current database.
'---------------------------------------------------------------------------------------
'
Private Sub Form_Load()
    LoadSampleConnectionStrings
End Sub


'---------------------------------------------------------------------------------------
' Procedure : LoadSampleConnectionStrings
' Author    : Adam Waller
' Date      : 8/1/2023
' Purpose   : Loads in some sample connection strings from the current database (from
'           : tables or pass-through queries) that can be selected by the user.
'---------------------------------------------------------------------------------------
'
Private Sub LoadSampleConnectionStrings()

    Dim dItems As Dictionary
    Dim varKey As Variant
    Dim varConn As Variant
    Dim strCurrent As String

    ' Take advantage of our connection class to retrieve some example
    ' connection strings from the current database.
    With New clsDbConnection
        Set dItems = .GetDictionary
    End With

    ' Save current value, and rebuild list
    strCurrent = Nz(cboConnect)
    cboConnect.RowSource = vbNullString

    ' Loop through the connection strings
    If Not dItems Is Nothing Then
        For Each varKey In dItems.Keys
            For Each varConn In dItems(varKey)
                If Len(varConn) > 10 Then
                    ' Looks like a connection string. Add to list.
                    cboConnect.AddItem """" & varConn & """"
                End If
            Next varConn
        Next varKey
    End If

    ' Restore original value
    cboConnect = strCurrent

End Sub
